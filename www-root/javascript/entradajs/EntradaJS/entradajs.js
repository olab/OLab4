'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var Resolver=function(){function Resolver(){_classCallCheck(this,Resolver)}_createClass(Resolver,[{key:'basename',value:function basename(filename){var filenameParts=filename.split('/');return filenameParts.pop()}},{key:'pathname',value:function pathname(filename){var filenameParts=filename.replace(/^\.\//,'').split('/');filenameParts.pop();return filenameParts.join('/')}},{key:'makeAbsolute',value:function makeAbsolute(path){var parts=path.split('/');for(var i=0;i<parts.length;i++){if(parts[i]==='..'){parts.splice(i-1,2)}}return parts.join('/')}},{key:'resolve',value:function resolve(filename,context_filename){var pathname=this.pathname(context_filename);if(filename.startsWith('./')){filename=pathname+'/'+filename.replace(/^\.\//,'')}return this.makeAbsolute(filename)}}]);return Resolver}();;var Loader=function(){function Loader(scriptPath){_classCallCheck(this,Loader);this.basePath=scriptPath||'';if(!this.basePath.endsWith('/')){this.basePath+='/'}this.resolver=new Resolver;this.handlers={};this.promises={};this.cache={}}_createClass(Loader,[{key:'registerExtension',value:function registerExtension(extension,handlerClass){this.handlers[extension]=Reflect.construct(handlerClass,[this])}},{key:'hasHandler',value:function hasHandler(extension){return!!this.handlers[extension]}},{key:'getHandler',value:function getHandler(extension){return this.handlers[extension]||null}},{key:'handle',value:function handle(filename,content){var extension='*';if(filename.match(/\.[a-z]+$/)){extension=filename.split('.').pop()}var handler=this.getHandler(extension);if(handler){return handler.handle(filename,content)}else{console.warn('A file handler is unavailable for: ',filename);return content}}},{key:'load',value:function load(filename){var _this=this;if(this.cache[filename]){return Promise.resolve(this.cache[filename])}if(this.promises[filename]){return this.promises[filename]}var url=this.basePath;if(!filename.startsWith('/')){url+='/'}url+=filename;if(!filename.match(/\.[a-z]+$/)){url+='.js'}var promise=fetch(url,{cache:'default',credentials:'same-origin',mode:'same-origin'}).then(function(response){if(response.ok){return response.text()}},function(error){console.error('Error loading file: '+filename,error);throw error}).then(function(rawFile){return _this.handle(filename,rawFile)}).then(function(handledFile){return _this.cache[filename]=handledFile});this.promises[filename]=promise;return promise}},{key:'resolveFilename',value:function resolveFilename(filename,contextFilename){return this.resolver.resolve(filename,contextFilename)}},{key:'findDependencies',value:function findDependencies(filename,file){var _this2=this;var dependencies=[];var contextFilename=filename;try{var use=function use(filename){filename=_this2.resolveFilename(filename,contextFilename);if(!dependencies.includes(filename)){dependencies.push(filename)}};var module={__dirname:this.resolver.pathname(contextFilename),__filename:contextFilename,exports:null};var process={env:{}};eval(file)}catch(err){}return dependencies}},{key:'bulkLoad',value:function bulkLoad(filenames){var promises=[];var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=filenames[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var filename=_step.value;promises.push(this.load(filename))}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return Promise.all(promises)}}]);return Loader}();;var Configuration=function(){function Configuration(){var values=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Configuration);this.attributes=values}_createClass(Configuration,[{key:'name',value:function name(){return this.attributes['name']}},{key:'version',value:function version(){return this.attributes['version']}},{key:'apiPath',value:function apiPath(){return this.attributes['apiPath']||'/api/v2'}},{key:'layoutNamespace',value:function layoutNamespace(){return this.attributes['layoutNamespace']||'/Layout'}},{key:'moduleNamespace',value:function moduleNamespace(){return this.attributes['moduleNamespace']||'/Module'}},{key:'registeredModules',value:function registeredModules(){return this.attributes['registeredModules']||[]}}]);return Configuration}();;var ClassHandler=function(){function ClassHandler(loader){_classCallCheck(this,ClassHandler);this.loader=loader}_createClass(ClassHandler,[{key:'handle',value:function handle(className,file){var _this3=this;var dependencies=this.loader.findDependencies(className,file);return this.loader.bulkLoad(dependencies).then(function(){return _this3.parse(className,file)})}},{key:'parse',value:function parse(filename,code){var _this4=this;var contextFilename=filename;var use=function use(filename){filename=_this4.loader.resolveFilename(filename,contextFilename);return _this4.loader.cache[filename]};var module={__dirname:this.loader.resolver.pathname(filename),__filename:contextFilename,exports:null};var process={env:{}};code+='//# sourceURL='+contextFilename;try{eval(code)}catch(error){console.error('Syntax error found while parsing class: '+filename,error)}if(module.exports&&module.exports.prototype){module.exports.prototype.__dirname=module.__dirname;module.exports.prototype.__filename=module.__filename}return Object.freeze(module.exports)}}]);return ClassHandler}();;var JsonHandler=function(){function JsonHandler(loader){_classCallCheck(this,JsonHandler);this.loader=loader}_createClass(JsonHandler,[{key:'handle',value:function handle(filename,file){return Promise.resolve(JSON.parse(file))}}]);return JsonHandler}();;var ScriptHandler=function(){function ScriptHandler(loader){_classCallCheck(this,ScriptHandler);this.loader=loader}_createClass(ScriptHandler,[{key:'handle',value:function handle(filename,file){var _this5=this;var dependencies=this.loader.findDependencies(filename,file);return this.loader.bulkLoad(dependencies).then(function(){return _this5.parse(filename,file)})}},{key:'parse',value:function parse(filename,code){var _this6=this;var contextFilename=filename;var use=function use(filename){filename=_this6.loader.resolveFilename(filename,contextFilename);return _this6.loader.cache[filename]};var module={__dirname:this.loader.resolver.pathname(filename),__filename:contextFilename,exports:null};var process={env:{}};code+='//# sourceURL='+contextFilename;try{eval(code)}catch(error){console.error('Syntax error found while parsing script: '+filename,error)}return module.exports}}]);return ScriptHandler}();;var VueHandler=function(){function VueHandler(loader){_classCallCheck(this,VueHandler);this.loader=loader}_createClass(VueHandler,[{key:'handle',value:function handle(filename,file){var _this7=this;var script=this.findScript(filename,file);var dependencies=this.loader.findDependencies(filename,script);return this.loader.bulkLoad(dependencies).then(function(){return _this7.parse(filename,file)})}},{key:'findScript',value:function findScript(filename,file){var $fragment=jQuery(file);return $fragment.filter('script').text()}},{key:'parse',value:function parse(filename,file){var _this8=this;var contextFilename=filename;var use=function use(filename){filename=_this8.loader.resolveFilename(filename,contextFilename);return _this8.loader.cache[filename]};var $fragment=jQuery(file);var template=$fragment.filter('template').html();var script=$fragment.filter('script').text();var style=$fragment.filter('style');jQuery(document.head).append(style);template=jQuery.trim(template);script=jQuery.trim(script);var module={};script+='//# sourceURL='+contextFilename;eval(script);var component=module.exports;component.template=template;return Vue.extend(component)}}]);return VueHandler}();;'use strict';var Bootstrap=function(){function Bootstrap(srcPath){_classCallCheck(this,Bootstrap);this.loader=new Loader(srcPath);this.loader.registerExtension('*',ClassHandler);this.loader.registerExtension('js',ScriptHandler);this.loader.registerExtension('json',JsonHandler);this.loader.registerExtension('vue',VueHandler)}_createClass(Bootstrap,[{key:'boot',value:function boot(selector){var _this9=this;if(jQuery(selector).length){return this.loadConfig().then(function(config){return _this9.loadApp(selector,config)})}else{}}},{key:'loadConfig',value:function loadConfig(){return this.loader.load('environment.js').then(function(environmentData){return new Configuration(environmentData)})}},{key:'loadApp',value:function loadApp(selector,config){var _this10=this;return this.loader.load('EntradaJS/App').then(function(App){return new App(selector,config,_this10.loader)})}}]);return Bootstrap}();;